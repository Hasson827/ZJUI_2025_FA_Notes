# 组合分析

一个有效的计算事件可能发生结果的数目的方法是非常有用的。概率论中的很多问题只要通过计算某个事件发生结果的数目就能得以解决。关于计数的数学理论通常称为**组合分析**(Combinatorial Analysis)

## 计数基本原则

**计数基本原则**：假设有两个试验，其中试验1有$m$种可能的结果，对应于试验1的每一个结果，试验2有$n$种可能的结果，则这两种试验一共有$mn$种可能的结果。

**推广的计数基本原则**：如果一共有$r$个试验，试验1有$n_{1}$种可能的结果，对应于试验1的每一种可能的结果，试验2有$n_{2}$种可能的结果，对应于前两个试验的每一种可能的结果，试验3有$n_{3}$种可能的结果……那么这$r$个试验一共有$n_{1}\times n_{2}\times\cdots\times n_{r}$种可能的结果。

## 排列

假设有$n$个元素，如果其中$n_{1}$个元素彼此相同，另$n_{2}$个彼此相同……$n_{r}$个也彼此相同，那么一共有
$$
\frac{n!}{n_{1}!n_{2}!\cdots n_{r}!}
$$
种不同的排列方式

## 组合

**记号与术语**：对于$r\le n$，我们定义$\binom{n}{r}$如下：
$$
\binom{n}{r} = \frac{n!}{(n-r)!r!}
$$
这样$\binom{n}{r}$（读作“n取r”）就表示从$n$个元素中一次取$r$个的可能组合数。因此，如果不考虑抽取顺序，则$\binom{n}{r}$就表示从$n$个元素中取$r$个元素所组成的不同组的数目。等价地，$\binom{n}{r}$就是从一个大小为$n$的集合中选出大小为$r$的子集的个数。由$0!=1$，注意到
$$
\binom{n}{n} = \binom{n}{0} = \frac{n!}{0!\times n!} = 1
$$
这与前面的解释是一致的，因为在一个大小为$n$的集合里恰好只有一个大小为$n$的子集（也就是全集），而且也恰好只有一个大小为0的子集（也就是空集）。一个有用的约定就是：当$r\gt n$或者$r\lt0$时，定义$\binom{n}{r} = 0$

**帕斯卡等式**：
$$
\binom{n}{r} = \binom{n-1}{r-1}+\binom{n-1}{r}
$$
**二项式定理**：
$$
(x+y)^{n} = \sum_{k=0}^{n}{\binom{n}{k}x^{k}y^{n-k}}
$$

## 多项式系数

问题：把$n$个不同的元素分成$r$组，每组分别有$n_{1},n_{2},\dots,n_{r}$个元素，其中$\sum_{i=1}^{r}{n_{i}} = n$，一共有多少种不同的分法？

第一组元素有$\binom{n}{n_{1}}$种选取方法，选定第一组元素后，只能从剩下的$n-n_{1}$个元素中选第二组元素，一共有$\binom{n-n_{1}}{n_{2}}$中选取方法，接下来第三组有$\binom{n-n_{1}-n_{2}}{n_{3}}$种选取方法，以此类推，可以得到将$n$个元素分成$r$组可能存在
$$
\binom{n}{n_{1}}\binom{n-n_{1}}{n_{2}}\cdots\binom{n-n_{1}-n_{2}-\dots-n_{r-1}}{n_{r}} = \frac{n!}{n_{1}!n_{2}!\cdots n_{r}!}
$$
**记号**：如果$\sum_{i=1}^{r}{n_{i}} = n$，则定义$\binom{n}{n_{1},n_{2},\dots,n_{r}}$为
$$
\binom{n}{n_{1},n_{2},\dots,n_{r}} = \frac{n!}{n_{1}!n_{2}!\cdots n_{r}!}
$$
因此，$\binom{n}{n_{1},n_{2},\dots,n_{r}}$表示把$n$个不同的元素分成大小分别为$n_{1},n_{2},\dots,n_{r}$的$r$个不同组的组合数。它也被称为多项式系数。

**多项式定理**：
$$
(x_{1}+x_{2}+\dots+x_{r})^{n} = \sum_{(n_{1},\cdots,n_{r}):n_{1}+\dots+n_{r}=n}{\binom{n}{n_{1},n_{2},\dots,n_{r}}x_{1}^{n_{1}}x_{2}^{n_{2}}\cdots x_{r}^{n_{r}}}
$$
上式的求和号是对满足$n_{1}+n_{2}+\dots+n_{r} = n$的所有非负整数向量$(n_{1},n_{2},\dots,n_{r})$求和。

## 方程的整数解个数

**正整数解个数**：共有$\binom{n-1}{r-1}$个不同的正整数向量$(x_{1},x_{2},\dots,x_{r})$满足
$$
x_{1}+x_{2}+\dots+x_{r} = n\qquad x_{i}\gt0,i=1,\dots,r
$$
假设有$n$个1，每两个1中间都有一个空隙可以用来插入“挡板”，而每两个挡板之间的“1”的个数就是$x_{i}$的数值，$n$个1中间一共有$n-1$个空隙，要想通过“挡板”分成$r$个组，就至少需要$r-1$个挡板，因此一共就是$\binom{n-1}{r-1}$种选取方法。

**非负整数解个数**：为了得到非负整数解的个数，注意$\sum_{i=1}^{r}{x_{i}} = n$的非负整数解个数与$\sum_{i=1}^{r}{y_{i}} = n+r$的正整数解个数是相同的，其中$y_{i} = x_{i}+1,\;i=1,\dots,r$，因此我们可以得到：共有$\binom{n+r-1}{r-1}$个不同的非负整数向量$(x_{1},x_{2},\dots,x_{r})$满足
$$
x_{1}+x_{2}+\dots+x_{r} = n\qquad x_{i}\ge0,i=1,\dots,r
$$
